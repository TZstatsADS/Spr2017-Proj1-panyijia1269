---
title: "The analysis of inaugurals during 1913~1953"
author: "Yijia Pan/yp2424"
output:
  html_document: default
  html_notebook: default
runtime: shiny
---
During 1931~1953, many big things happened such as the World War I, the World War II and the Great Depression. So I want to do a research on what presidents have said during these period.

# Part 1: what did these presidents say during 1913~1953?

| President       | Period   |
| ----------------|:------------------:|
|Woodrow Wilson|    1913-1921|
|Warren G. Harding|1921-1923|
|Herbert Hoover|  1929-1933|
|Franklin D. Roosevelt |1933-1945|
|Harry S. Truman| 1945-1953 |

```{r,include=FALSE}
library(tm)
library(wordcloud)
library(RColorBrewer)
library(dplyr)
library(tidytext)
```

## Step 1 - Read in the speeches
```{r}
folder.path="../data/InauguralSpeeches/"
speeches=list.files(path = folder.path, pattern = "*.txt")
prex.out=substr(speeches, 6, nchar(speeches)-4)
ff.all<-Corpus(DirSource(folder.path,encoding = "UTF-8"))
```

##Step 2 - Text processing

```{r}
ff.all<-tm_map(ff.all, stripWhitespace)
ff.all<-tm_map(ff.all, content_transformer(tolower))
ff.all<-tm_map(ff.all, removeWords, stopwords("english"))
ff.all<-tm_map(ff.all, removeWords, character(0))
ff.all<-tm_map(ff.all, removePunctuation)

tdm.all<-TermDocumentMatrix(ff.all)

tdm.tidy=tidy(tdm.all)

tdm.overall=summarise(group_by(tdm.tidy, term), sum(count))
```

##Step 4 - compute TF-IDF weighted document-term matrices for individual speeches. 

```{r}
dtm <- DocumentTermMatrix(ff.all,
                          control = list(weighting = function(x)
                                             weightTfIdf(x, 
                                                         normalize =FALSE),
                                         stopwords = TRUE))
ff.dtm=tidy(dtm)
```

##Step 5- Interactive visualize important words in individual speeches
```{r, warning=FALSE}
library(shiny)

shinyApp(
    ui = fluidPage(
      fluidRow(style = "padding-bottom: 20px;",
        column(4, selectInput('speech1', 'Speech 1',
                              speeches,
                              selected=speeches[5])),
        column(4, selectInput('speech2', 'Speech 2', speeches,
                              selected=speeches[9])),
        column(4, sliderInput('nwords', 'Number of words', 3,
                               min = 20, max = 200, value=100, step = 20))
      ),
      fluidRow(
        plotOutput('wordclouds', height = "400px")
      )
    ),

    server = function(input, output, session) {

      # Combine the selected variables into a new data frame
      selectedData <- reactive({
        list(dtm.term1=ff.dtm$term[ff.dtm$document==as.character(input$speech1)],
             dtm.count1=ff.dtm$count[ff.dtm$document==as.character(input$speech1)],
             dtm.term2=ff.dtm$term[ff.dtm$document==as.character(input$speech2)],
             dtm.count2=ff.dtm$count[ff.dtm$document==as.character(input$speech2)])
      })

      output$wordclouds <- renderPlot(height = 400, {
        par(mfrow=c(1,2), mar = c(0, 0, 3, 0))
        wordcloud(selectedData()$dtm.term1, 
                  selectedData()$dtm.count1,
              scale=c(4,0.5),
              max.words=input$nwords,
              min.freq=1,
              random.order=FALSE,
              rot.per=0,
              use.r.layout=FALSE,
              random.color=FALSE,
              colors=brewer.pal(10,"Blues"), 
            main=input$speech1)
        wordcloud(selectedData()$dtm.term2, 
                  selectedData()$dtm.count2,
              scale=c(4,0.5),
              max.words=input$nwords,
              min.freq=1,
              random.order=FALSE,
              rot.per=0,
              use.r.layout=FALSE,
              random.color=FALSE,
              colors=brewer.pal(10,"Blues"), 
            main=input$speech2)
      })
    },

    options = list(height = 600)
)
```

## Step 6 - Data analysis

If we search those presidents by using shinny, we can find there are some frequently mentioned topics of different presidents.

+ 1913~1928 (Woodrow Wilson/Warren G. Harding)

For the United States, this period means prosperity. The US became the leading super power of the world, and old empire states such as the UK, Germany or France became weaker due to the World War I. According to our research, the top word of President Wilson is “wished.” The term “wished” is easy to understand since now the European countries were involved in the war, and he had to wish for the peace. What’s more, for “politics,” “seas” and “arm” these terms, we can very easily think of the war. However, since the war did not happen on the land of the US, it seems that President Wilson did not use too strong words. When the war ended, we can see that these “war-related” terms disappeared in President Harding’s and President Coolidge’s script. In this two, the terms related to the economy or normal lives were talked most. For example, “civilization,” “tax” and “dollar.” For most Americans, this era means opportunity and wealth.

+ 1929~1940 (Herbert Hoover/Franklin D. Roosevelt (1st and 2st term))

This era is one of the most interesting period in the history of the US. When President Hoover first came out, he focused on the 18th amendment, which prohibited the selling and consuming the alcohol and brought the US to the famous “Prohibition Era.” During this period, dealing with organized criminals caused by alcohol smuggling was the core of his speech. However, the great depression later came, and President Roosevelt used many words related to the depression, such as “helped,” “emergency,” “money” and “dark.” During the Great Depression, farmers were harmed a lot. Therefore, we can see the word such as “farm” and “epidemics” in his second speech.

+ 1941~1945 (Franklin D. Roosevelt (3rd and 4th term)/HerberHoover)

The US was involved into the World War II. On December 1941, the attack of Japanese Navy to the Peril Harbor was emphasized by President Roosevelt. As we expect, he used words like “fire,” “die” and “dire” which are the words related to the war. More importantly, the word “democracy” was mentioned several times due to criticize the dictatorship happened in the Axis Powers.